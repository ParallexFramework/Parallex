function arrayObserve(a,b,c){function d(){if(Array.isArray(a))var f=e;else var f=Object.keys(e);f.forEach(function(g){if(Array.isArray(e))var h=e.lastIndexOf(g);else var h=g;Object.defineProperty(a,h,{configurable:!0,enumerable:!0,set:function(i){e[h]=i,b.call(c,e,h)},get:function(){return e[h]}}),'object'==typeof e[h]&&arrayObserve(e[h],b,e)})}if(Array.isArray(a)){var e=[];e.push.apply(e,a)}else var e=Object.assign({},a);return d(),Array.isArray(a)&&['pop','push','reverse','shift','unshift','splice','sort','map','filter'].forEach(function(f){Object.defineProperty(a,f,{configurable:!1,enumerable:!1,writable:!0,value:function(){if(-1<['push','pop','reverse','shift','unshift'].indexOf(f))Array.prototype[f].apply(e,arguments);else{var h=Array.prototype[f].apply(e,arguments);e=h}return b.call(c,e,null),d(),e}})}),e}var Parallex=function(a){var b={container:document.querySelector(a.elm)||document.body,lastElement:this.container,lists:[],data:a.data||{},list:function(c,d){if('object'!=typeof d&&'object'==typeof c&&(d=c),'string'!=typeof d.elm)var e=this.lastElement;else var e=document.querySelector(d.elm);if('string'!=typeof c&&'string'!=typeof d.name)return this;'string'!=typeof c&&(c=d.name),this.lastElement=e;var f=e.parentNode;if(!Array.isArray(d.content))return this;for(var g=d.content,h=d.content,i='';f.firstChild;)f.removeChild(f.firstChild);for(var j=0;j<h.length;){if(i=h[j],'string'==typeof i){var k=e.cloneNode();k.innerHTML=i,f.appendChild(k)}j++}if(!this.lists[c]){this.lists[c]=g;var l=this;arrayObserve(this.lists[c],function(m){d.content=m,l.list(c,d)},null)}return this},testConditional:function(c,d){return new Function(...Object.keys(d),'return '+c).apply(this,Object.values(d))},parseTemplate:function(){function c(h){document.querySelectorAll('p-data').forEach(function(i){i.innerHTML=h[i.getAttribute('data-name')]})}function d(h){document.querySelectorAll('[p-if]').forEach(function(i){var j=i,k=e.testConditional(i.getAttribute('p-if'),h),l=i.nextElementSibling.hasAttribute('p-else'),m=i.nextElementSibling.hasAttribute('p-else-if');if(k){if(i.style.display='',l)i.nextElementSibling.style.display='none';else if(m&&null!==j.nextElementSibling)for(;j.nextElementSibling&&j.nextElementSibling.hasAttribute('p-elseif');)j=j.nextElementSibling,j.style.display='none';}else if(l)i.style.display='none',i.nextElementSibling.style.display='';else if(m)for(var n=!1;j.nextElementSibling&&j.nextElementSibling.hasAttribute('p-elseif');)j=j.nextElementSibling,n?j.style.display='none':(k=e.testConditional(j.getAttribute('p-elseif'),h),l=j.nextElementSibling&&j.nextElementSibling.hasAttribute('p-else'),k?(n=!0,i.style.display='none',j.style.display='',l&&(j.nextElementSibling.style.display='none')):l?(j.style.display='none',j.nextElementSibling.style.display='none'):j.style.display='none');else i.style.display='none'})}var e=this,f=[];c(e.data);var g=0;document.querySelectorAll('[p-attributes]').forEach(function(h){var i=h.attributes,j=0;for(h.setAttribute('p-attributes','p-index-'+g);j<i.length;){var k=i[j];if(/^\[\[.*\]\]$/.test(k.value)){var l=k.value.replace(/[\[]|[\]]/g,'');f[l]={element:'p-index-'+g,attribute:k.name},h.setAttribute(k.name,e.data[l])}j++}g++}),data=b.container.innerHTML,data=data.replace(/(?<!\\)(?:(\\\\)*)[\[]{2,}(\w+?)(?<!\\)(?:(\\\\)*)[\]]{2,}/g,function(h){h=h.replace(/[\[]|[\]]/g,'');var i=Object.keys(e.data).indexOf(h),j=-1<Object.keys(f).indexOf(h);return-1<i&&!j?'<p-data data-name="'+h+'">'+e.data[h]+'</p-data>':j?void 0:'[['+h+']]'}),b.container.innerHTML=data,d(this.data),arrayObserve(e.data,function(h,i){if(i){var j=f[i];if(j){var k=document.querySelector('[p-attributes='+j.element+']');k.setAttribute(j.attribute,h[i])}}d(h),c(h)},null)},event:function(c,d){var e=document.querySelectorAll('[p-on$=":'+c+'"]'),f=this;e.forEach(function(g){var h=g.getAttribute('p-on').split(':'),i=h[0],j=h[1];(j=c)&&g.addEventListener(i,function(k){var l=d.call(g,k,f);return l})})}};return b.parseTemplate(),b};
